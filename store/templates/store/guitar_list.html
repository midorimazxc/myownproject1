{% extends "store/base.html" %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ –≥–∏—Ç–∞—Ä{% endblock %}

{% block content %}
<h1>–ö–∞—Ç–∞–ª–æ–≥ –≥–∏—Ç–∞—Ä</h1>

<div class="toolbar">
    <form method="get" class="search-bar">
        <input type="text" name="q" placeholder="üîç –ü–æ–∏—Å–∫..." value="{{ request.GET.q }}">
        <button type="submit">–ù–∞–π—Ç–∏</button>
    </form>

    <form method="get" class="filter">
        <select name="category" onchange="this.form.submit()">
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            {% for c in categories %}
                <option value="{{ c.id }}" {% if request.GET.category == c.id|stringformat:"s" %}selected{% endif %}>
                    {{ c.name }}
                </option>
            {% endfor %}
        </select>
    </form>
</div>

<ul class="product-list">
    {% for guitar in guitars %}
        <li class="product-card">
            {% if guitar.image %}
                <img src="{{ guitar.image.url }}" alt="{{ guitar.name }}">
            {% endif %}
            <div class="product-info">
                <h3><a href="{% url 'store:guitar_detail' guitar.pk %}">{{ guitar.name }}</a></h3>
                <p class="price">${{ guitar.price }}</p>
                <p class="rating">
                    {% if guitar.get_average_rating %}
                        ‚≠ê {{ guitar.get_average_rating }}/5
                    {% else %}
                        –ü–æ–∫–∞ –Ω–µ—Ç –æ—Ü–µ–Ω–æ–∫
                    {% endif %}
                </p>
                <a href="{% url 'store:guitar_detail' guitar.pk %}" class="details-btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
        </li>
    {% empty %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤, –∏–∑–≤–∏–Ω–∏—Ç–µ!</p>
    {% endfor %}
</ul>

<div class="cart-link">
    <h3><a href="{% url 'store:cart_detail' %}">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</a></h3>
</div>
{% endblock %}
